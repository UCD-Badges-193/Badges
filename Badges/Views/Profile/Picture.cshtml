@model dynamic

@{
    ViewBag.Title = "Profile Picture";
}

<h2>Profile Picture</h2>

<form>
    <div class="form-group">
        <img id="img-preview" alt="profile preview"/> || <canvas id="canvas-preview"></canvas>
    </div>
    <div class="form-group">
        <label>Upload File</label>
        <input id="profile-upload" type="file"/>
    </div>
    <div class="form-actions">
        <button type="submit">Submit</button>
    </div>
</form>

@section AdditionalScripts
{
    <script>
        $(function() {
            $("#profile-upload").on('change', function() {
                // from an input element
                var filesToUpload = this.files;

                if (filesToUpload.length !== 1) return;

                var file = filesToUpload[0];

                if (!file.type.match(/image.*/)) {
                    alert("only images, please");
                }
                
                var img = document.createElement("img");
                
                //var img = document.getElementById("img-preview");
                //img.src = window.URL.createObjectURL(file);

                //var img = document.getElementById("img-preview");
                var reader = new FileReader();
                reader.onload = function (e) { img.src = e.target.result; };
                reader.readAsDataURL(file);

                //var canvas = $("#canvas-preview")[0];

                //var MAX_WIDTH = 120;
                //var MAX_HEIGHT = 120;
                //var width = img.width;
                //var height = img.height;

                //if (width > height) {
                //    if (width > MAX_WIDTH) {
                //        height *= MAX_WIDTH / width;
                //        width = MAX_WIDTH;
                //    }
                //} else {
                //    if (height > MAX_HEIGHT) {
                //        width *= MAX_HEIGHT / height;
                //        height = MAX_HEIGHT;
                //    }
                //}
                //canvas.width = width;
                //canvas.height = height;

                var canvas = document.getElementById("canvas-preview");
                var ctx = canvas.getContext("2d");
                ctx.drawImage(img, 0, 0, 120, 120);
                //ctx.drawImage(img, 0, 0, width, height);
            });
        });
    </script>
}